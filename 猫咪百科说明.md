# 猫咪百科功能前端开发文档

## 1. 功能概述

猫咪百科功能提供了猫咪相关的详细信息，包括猫咪学名、品种名、特征、习性、养护指南、行为解析、趣味知识、图片和稀有度等。前端可以通过API接口实现猫咪百科的增删改查、分页和品种名筛选等功能。

## 2. API接口说明

### 2.1 获取猫咪百科列表

- **请求URL**：`http://localhost:3000/api/encyclopedias`
- **请求方法**：GET
- **请求参数**：
  - `page`：页码，默认值为1
  - `limit`：每页数量，默认值为10
  - `breed`：品种名，用于筛选
- **请求示例**：
  ```javascript
  // 获取第一页，每页5条，品种名为"孟买"的猫咪百科列表
  fetch('http://localhost:3000/api/encyclopedias?page=1&limit=5&breed=孟买', {
    method: 'GET',
    headers: {
      'Authorization': 'Bearer your-token-here'
    }
  })
  .then(response => response.json())
  .then(data => console.log(data));
  ```
- **响应示例**：
  ```json
  {
    "encyclopedias": [
      {
        "id": 1,
        "scientific_name": "Felis catus",
        "breed": "孟买猫",
        "characteristics": "孟买猫是一种黑色的短毛猫，体型中等，肌肉发达，眼睛呈金黄色或铜色。",
        "habits": "孟买猫性格温和，喜欢与人互动，适应性强，适合室内生活。",
        "care_guide": "孟买猫需要定期梳理毛发，保持口腔卫生，提供均衡的饮食，定期接种疫苗。",
        "behavior_analysis": "孟买猫聪明活泼，喜欢玩耍，对主人忠诚，有时会表现出猫的独立性。",
        "fun_facts": "孟买猫是由美国育种学家在1950年代培育出来的，旨在创造一种类似黑豹的家猫。",
        "images": ["bombay1.jpg", "bombay2.jpg"],
        "rarity": "稀有",
        "created_at": "2026-02-26T05:51:19.000Z",
        "updated_at": "2026-02-26T05:58:17.000Z"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 5,
      "total": 1,
      "totalPages": 1
    }
  }
  ```

### 2.2 获取猫咪百科详情

- **请求URL**：`http://localhost:3000/api/encyclopedias/:id`
- **请求方法**：GET
- **请求参数**：
  - `id`：猫咪百科ID，路径参数
- **请求示例**：
  ```javascript
  // 获取ID为1的猫咪百科详情
  fetch('http://localhost:3000/api/encyclopedias/1', {
    method: 'GET',
    headers: {
      'Authorization': 'Bearer your-token-here'
    }
  })
  .then(response => response.json())
  .then(data => console.log(data));
  ```
- **响应示例**：
  ```json
  {
    "id": 1,
    "scientific_name": "Felis catus",
    "breed": "孟买猫",
    "characteristics": "孟买猫是一种黑色的短毛猫，体型中等，肌肉发达，眼睛呈金黄色或铜色。",
    "habits": "孟买猫性格温和，喜欢与人互动，适应性强，适合室内生活。",
    "care_guide": "孟买猫需要定期梳理毛发，保持口腔卫生，提供均衡的饮食，定期接种疫苗。",
    "behavior_analysis": "孟买猫聪明活泼，喜欢玩耍，对主人忠诚，有时会表现出猫的独立性。",
    "fun_facts": "孟买猫是由美国育种学家在1950年代培育出来的，旨在创造一种类似黑豹的家猫。",
    "images": ["bombay1.jpg", "bombay2.jpg"],
    "rarity": "稀有",
    "created_at": "2026-02-26T05:51:19.000Z",
    "updated_at": "2026-02-26T05:58:17.000Z"
  }
  ```

### 2.3 增加猫咪百科

- **请求URL**：`http://localhost:3000/api/encyclopedias`
- **请求方法**：POST
- **请求参数**：
  - `scientific_name`：猫咪学名，必填
  - `breed`：品种名，必填
  - `characteristics`：猫咪特征，可选
  - `habits`：猫咪习性，可选
  - `care_guide`：猫咪养护指南，可选
  - `behavior_analysis`：猫咪行为解析，可选
  - `fun_facts`：趣味知识，可选
  - `images`：猫咪图片，JSON数组，可选
  - `rarity`：猫咪的稀有度，可选
- **请求示例**：
  ```javascript
  // 增加一个新的猫咪百科条目
  fetch('http://localhost:3000/api/encyclopedias', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': 'Bearer your-token-here'
    },
    body: JSON.stringify({
      "scientific_name": "Felis catus",
      "breed": "孟买猫",
      "characteristics": "孟买猫是一种黑色的短毛猫，体型中等，肌肉发达，眼睛呈金黄色或铜色。",
      "habits": "孟买猫性格温和，喜欢与人互动，适应性强，适合室内生活。",
      "care_guide": "孟买猫需要定期梳理毛发，保持口腔卫生，提供均衡的饮食，定期接种疫苗。",
      "behavior_analysis": "孟买猫聪明活泼，喜欢玩耍，对主人忠诚，有时会表现出猫的独立性。",
      "fun_facts": "孟买猫是由美国育种学家在1950年代培育出来的，旨在创造一种类似黑豹的家猫。",
      "images": ["bombay1.jpg", "bombay2.jpg"],
      "rarity": "稀有"
    })
  })
  .then(response => response.json())
  .then(data => console.log(data));
  ```
- **响应示例**：
  ```json
  {
    "id": 1,
    "scientific_name": "Felis catus",
    "breed": "孟买猫",
    "characteristics": "孟买猫是一种黑色的短毛猫，体型中等，肌肉发达，眼睛呈金黄色或铜色。",
    "habits": "孟买猫性格温和，喜欢与人互动，适应性强，适合室内生活。",
    "care_guide": "孟买猫需要定期梳理毛发，保持口腔卫生，提供均衡的饮食，定期接种疫苗。",
    "behavior_analysis": "孟买猫聪明活泼，喜欢玩耍，对主人忠诚，有时会表现出猫的独立性。",
    "fun_facts": "孟买猫是由美国育种学家在1950年代培育出来的，旨在创造一种类似黑豹的家猫。",
    "images": ["bombay1.jpg", "bombay2.jpg"],
    "rarity": "稀有",
    "created_at": "2026-02-26T05:51:19.000Z",
    "updated_at": "2026-02-26T05:51:19.000Z"
  }
  ```

### 2.4 修改猫咪百科

- **请求URL**：`http://localhost:3000/api/encyclopedias/:id`
- **请求方法**：PUT
- **请求参数**：
  - `id`：猫咪百科ID，路径参数
  - `scientific_name`：猫咪学名，必填
  - `breed`：品种名，必填
  - `characteristics`：猫咪特征，可选
  - `habits`：猫咪习性，可选
  - `care_guide`：猫咪养护指南，可选
  - `behavior_analysis`：猫咪行为解析，可选
  - `fun_facts`：趣味知识，可选
  - `images`：猫咪图片，JSON数组，可选
  - `rarity`：猫咪的稀有度，可选
- **请求示例**：
  ```javascript
  // 修改ID为1的猫咪百科条目
  fetch('http://localhost:3000/api/encyclopedias/1', {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': 'Bearer your-token-here'
    },
    body: JSON.stringify({
      "scientific_name": "Felis catus",
      "breed": "孟买猫",
      "characteristics": "孟买猫是一种黑色的短毛猫，体型中等，肌肉发达，眼睛呈金黄色或铜色。",
      "habits": "孟买猫性格温和，喜欢与人互动，适应性强，适合室内生活。",
      "care_guide": "孟买猫需要定期梳理毛发，保持口腔卫生，提供均衡的饮食，定期接种疫苗。",
      "behavior_analysis": "孟买猫聪明活泼，喜欢玩耍，对主人忠诚，有时会表现出猫的独立性。",
      "fun_facts": "孟买猫是由美国育种学家在1950年代培育出来的，旨在创造一种类似黑豹的家猫。",
      "images": ["bombay1.jpg", "bombay2.jpg"],
      "rarity": "普通"
    })
  })
  .then(response => response.json())
  .then(data => console.log(data));
  ```
- **响应示例**：
  ```json
  {
    "id": 1,
    "scientific_name": "Felis catus",
    "breed": "孟买猫",
    "characteristics": "孟买猫是一种黑色的短毛猫，体型中等，肌肉发达，眼睛呈金黄色或铜色。",
    "habits": "孟买猫性格温和，喜欢与人互动，适应性强，适合室内生活。",
    "care_guide": "孟买猫需要定期梳理毛发，保持口腔卫生，提供均衡的饮食，定期接种疫苗。",
    "behavior_analysis": "孟买猫聪明活泼，喜欢玩耍，对主人忠诚，有时会表现出猫的独立性。",
    "fun_facts": "孟买猫是由美国育种学家在1950年代培育出来的，旨在创造一种类似黑豹的家猫。",
    "images": ["bombay1.jpg", "bombay2.jpg"],
    "rarity": "普通",
    "created_at": "2026-02-26T05:51:19.000Z",
    "updated_at": "2026-02-26T05:58:17.000Z"
  }
  ```

### 2.5 删除猫咪百科

- **请求URL**：`http://localhost:3000/api/encyclopedias/:id`
- **请求方法**：DELETE
- **请求参数**：
  - `id`：猫咪百科ID，路径参数
- **请求示例**：
  ```javascript
  // 删除ID为1的猫咪百科条目
  fetch('http://localhost:3000/api/encyclopedias/1', {
    method: 'DELETE',
    headers: {
      'Authorization': 'Bearer your-token-here'
    }
  })
  .then(response => response.json())
  .then(data => console.log(data));
  ```
- **响应示例**：
  ```json
  {
    "message": "Encyclopedia deleted successfully"
  }
  ```

## 3. 前端实现建议

### 3.1 页面结构

- **猫咪百科列表页**：显示猫咪百科的列表，支持分页和品种名筛选
- **猫咪百科详情页**：显示猫咪百科的详细信息
- **猫咪百科编辑页**：用于增加和修改猫咪百科

### 3.2 功能实现

- **分页功能**：使用`page`和`limit`参数控制页码和每页数量，显示分页控件
- **品种名筛选**：使用`breed`参数筛选符合条件的猫咪百科条目，提供搜索框
- **图片上传**：支持上传多张猫咪图片，使用JSON数组存储
- **表单验证**：对必填字段进行验证，确保数据的完整性

### 3.3 代码示例

#### 3.3.1 猫咪百科列表页

```javascript
// 获取猫咪百科列表
async function getEncyclopedias(page = 1, limit = 10, breed = '') {
  try {
    const response = await fetch(`http://localhost:3000/api/encyclopedias?page=${page}&limit=${limit}&breed=${breed}`, {
      method: 'GET',
      headers: {
        'Authorization': 'Bearer your-token-here'
      }
    });
    const data = await response.json();
    return data;
  } catch (error) {
    console.error('Error getting encyclopedias:', error);
    return { encyclopedias: [], pagination: { page: 1, limit: 10, total: 0, totalPages: 0 } };
  }
}

// 渲染猫咪百科列表
function renderEncyclopedias(encyclopedias) {
  const container = document.getElementById('encyclopedias-container');
  container.innerHTML = '';
  
  encyclopedias.forEach(encyclopedia => {
    const card = document.createElement('div');
    card.className = 'encyclopedia-card';
    card.innerHTML = `
      <h3>${encyclopedia.breed}</h3>
      <p>${encyclopedia.scientific_name}</p>
      <p>${encyclopedia.characteristics}</p>
      <p>稀有度：${encyclopedia.rarity}</p>
      <button onclick="viewEncyclopedia(${encyclopedia.id})">查看详情</button>
      <button onclick="editEncyclopedia(${encyclopedia.id})">编辑</button>
      <button onclick="deleteEncyclopedia(${encyclopedia.id})">删除</button>
    `;
    container.appendChild(card);
  });
}

// 渲染分页控件
function renderPagination(pagination) {
  const container = document.getElementById('pagination-container');
  container.innerHTML = '';
  
  // 上一页按钮
  const prevButton = document.createElement('button');
  prevButton.textContent = '上一页';
  prevButton.disabled = pagination.page === 1;
  prevButton.onclick = () => loadEncyclopedias(pagination.page - 1);
  container.appendChild(prevButton);
  
  // 页码按钮
  for (let i = 1; i <= pagination.totalPages; i++) {
    const pageButton = document.createElement('button');
    pageButton.textContent = i;
    pageButton.className = pagination.page === i ? 'active' : '';
    pageButton.onclick = () => loadEncyclopedias(i);
    container.appendChild(pageButton);
  }
  
  // 下一页按钮
  const nextButton = document.createElement('button');
  nextButton.textContent = '下一页';
  nextButton.disabled = pagination.page === pagination.totalPages;
  nextButton.onclick = () => loadEncyclopedias(pagination.page + 1);
  container.appendChild(nextButton);
}

// 加载猫咪百科列表
async function loadEncyclopedias(page = 1) {
  const breed = document.getElementById('breed-input').value;
  const data = await getEncyclopedias(page, 10, breed);
  renderEncyclopedias(data.encyclopedias);
  renderPagination(data.pagination);
}

// 初始化页面
document.addEventListener('DOMContentLoaded', () => {
  loadEncyclopedias();
  
  // 品种名筛选
  document.getElementById('breed-input').addEventListener('input', () => {
    loadEncyclopedias(1);
  });
});
```

#### 3.3.2 猫咪百科详情页

```javascript
// 获取猫咪百科详情
async function getEncyclopediaById(id) {
  try {
    const response = await fetch(`http://localhost:3000/api/encyclopedias/${id}`, {
      method: 'GET',
      headers: {
        'Authorization': 'Bearer your-token-here'
      }
    });
    const data = await response.json();
    return data;
  } catch (error) {
    console.error('Error getting encyclopedia:', error);
    return null;
  }
}

// 渲染猫咪百科详情
async function viewEncyclopedia(id) {
  const encyclopedia = await getEncyclopediaById(id);
  if (!encyclopedia) return;
  
  const container = document.getElementById('encyclopedia-detail-container');
  container.innerHTML = `
    <h2>${encyclopedia.breed}</h2>
    <p><strong>学名：</strong>${encyclopedia.scientific_name}</p>
    <p><strong>特征：</strong>${encyclopedia.characteristics}</p>
    <p><strong>习性：</strong>${encyclopedia.habits}</p>
    <p><strong>养护指南：</strong>${encyclopedia.care_guide}</p>
    <p><strong>行为解析：</strong>${encyclopedia.behavior_analysis}</p>
    <p><strong>趣味知识：</strong>${encyclopedia.fun_facts}</p>
    <p><strong>稀有度：</strong>${encyclopedia.rarity}</p>
    <div><strong>图片：</strong></div>
    <div class="images-container">
      ${encyclopedia.images.map(image => `<img src="${image}" alt="${encyclopedia.breed}">`).join('')}
    </div>
    <button onclick="goBack()">返回列表</button>
  `;
}
```

#### 3.3.3 猫咪百科编辑页

```javascript
// 增加或修改猫咪百科
async function saveEncyclopedia(id, data) {
  try {
    const url = id ? `http://localhost:3000/api/encyclopedias/${id}` : 'http://localhost:3000/api/encyclopedias';
    const method = id ? 'PUT' : 'POST';
    
    const response = await fetch(url, {
      method: method,
      headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer your-token-here'
      },
      body: JSON.stringify(data)
    });
    const result = await response.json();
    return result;
  } catch (error) {
    console.error('Error saving encyclopedia:', error);
    return null;
  }
}

// 编辑猫咪百科
async function editEncyclopedia(id) {
  const encyclopedia = id ? await getEncyclopediaById(id) : null;
  
  const container = document.getElementById('encyclopedia-edit-container');
  container.innerHTML = `
    <h2>${id ? '编辑猫咪百科' : '增加猫咪百科'}</h2>
    <form id="encyclopedia-form">
      <div>
        <label for="scientific_name">学名：</label>
        <input type="text" id="scientific_name" name="scientific_name" value="${encyclopedia?.scientific_name || ''}" required>
      </div>
      <div>
        <label for="breed">品种名：</label>
        <input type="text" id="breed" name="breed" value="${encyclopedia?.breed || ''}" required>
      </div>
      <div>
        <label for="characteristics">特征：</label>
        <textarea id="characteristics" name="characteristics">${encyclopedia?.characteristics || ''}</textarea>
      </div>
      <div>
        <label for="habits">习性：</label>
        <textarea id="habits" name="habits">${encyclopedia?.habits || ''}</textarea>
      </div>
      <div>
        <label for="care_guide">养护指南：</label>
        <textarea id="care_guide" name="care_guide">${encyclopedia?.care_guide || ''}</textarea>
      </div>
      <div>
        <label for="behavior_analysis">行为解析：</label>
        <textarea id="behavior_analysis" name="behavior_analysis">${encyclopedia?.behavior_analysis || ''}</textarea>
      </div>
      <div>
        <label for="fun_facts">趣味知识：</label>
        <textarea id="fun_facts" name="fun_facts">${encyclopedia?.fun_facts || ''}</textarea>
      </div>
      <div>
        <label for="images">图片：</label>
        <input type="text" id="images" name="images" value="${encyclopedia?.images?.join(',') || ''}" placeholder="多张图片用逗号分隔">
      </div>
      <div>
        <label for="rarity">稀有度：</label>
        <select id="rarity" name="rarity">
          <option value="普通" ${encyclopedia?.rarity === '普通' ? 'selected' : ''}>普通</option>
          <option value="稀有" ${encyclopedia?.rarity === '稀有' ? 'selected' : ''}>稀有</option>
          <option value="极稀有" ${encyclopedia?.rarity === '极稀有' ? 'selected' : ''}>极稀有</option>
        </select>
      </div>
      <button type="submit">保存</button>
      <button type="button" onclick="goBack()">取消</button>
    </form>
  `;
  
  // 表单提交
  document.getElementById('encyclopedia-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const formData = new FormData(e.target);
    const data = {
      scientific_name: formData.get('scientific_name'),
      breed: formData.get('breed'),
      characteristics: formData.get('characteristics'),
      habits: formData.get('habits'),
      care_guide: formData.get('care_guide'),
      behavior_analysis: formData.get('behavior_analysis'),
      fun_facts: formData.get('fun_facts'),
      images: formData.get('images') ? formData.get('images').split(',') : [],
      rarity: formData.get('rarity')
    };
    
    const result = await saveEncyclopedia(id, data);
    if (result) {
      alert('保存成功！');
      goBack();
    } else {
      alert('保存失败！');
    }
  });
}

// 删除猫咪百科
async function deleteEncyclopedia(id) {
  if (!confirm('确定要删除这个猫咪百科条目吗？')) return;
  
  try {
    const response = await fetch(`http://localhost:3000/api/encyclopedias/${id}`, {
      method: 'DELETE',
      headers: {
        'Authorization': 'Bearer your-token-here'
      }
    });
    const data = await response.json();
    if (data.message) {
      alert('删除成功！');
      loadEncyclopedias();
    } else {
      alert('删除失败！');
    }
  } catch (error) {
    console.error('Error deleting encyclopedia:', error);
    alert('删除失败！');
  }
}
```

## 4. 总结

猫咪百科功能为前端提供了丰富的API接口，可以实现猫咪百科的增删改查、分页和品种名筛选等功能。前端可以根据这些接口实现用户友好的界面，为用户提供详细的猫咪相关信息。

通过本文档的API接口说明和代码示例，前端开发人员可以快速集成猫咪百科功能，为用户提供更好的体验。